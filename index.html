<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P616VLN7JC"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-P616VLN7JC');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Supplier Vendor Calculator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #e6f4ea;
            color: #2d6a4f;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 100, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #2d6a4f;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        .tab {
            overflow: hidden;
            border-bottom: 2px solid #74c69d;
            margin-bottom: 20px;
        }

        .tab button {
            background-color: #f0fff5;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 20px;
            transition: 0.3s;
            font-size: 1.1em;
            color: #2d6a4f;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
        }

        .tab button:hover {
            background-color: #d8f3dc;
        }

        .tab button.active {
            background-color: #40916c;
            color: white;
        }

        .tabcontent {
            display: none;
            padding: 20px;
            border: 1px solid #74c69d;
            border-radius: 0 0 8px 8px;
            background-color: #f0fff5;
        }

        h3 {
            color: #40916c;
            border-bottom: 2px solid #74c69d;
            padding-bottom: 5px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2d6a4f;
        }

        input,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #74c69d;
            border-radius: 5px;
            box-sizing: border-box;
            background-color: #ffffff;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            max-height: 250px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #74c69d;
            border-radius: 5px;
            background-color: #ffffff;
        }

        .checkbox-group label {
            margin: 5px 0;
            font-weight: normal;
        }

        #formalSubTypeContainer,
        #informalSubTypeContainer {
            display: none;
        }

        #formalResult,
        #informalResult {
            margin-top: 25px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
            background-color: #f0fff5;
            border: 2px solid #74c69d;
        }

        .green {
            background-color: #d8f3dc;
            color: #2d6a4f;
        }

        .yellow {
            background-color: #fff3cd;
            color: #856404;
        }

        .red {
            background-color: #f8d7da;
            color: #721c24;
        }

        .button-group {
            text-align: center;
            margin-top: 20px;
        }

        button {
            padding: 12px 25px;
            margin: 0 10px;
            background-color: #40916c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2d6a4f;
        }

        .weightage {
            font-size: 0.9em;
            color: #52796f;
            margin-left: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Green Supplier Vendor Calculator</h1>

        <div class="tab">
            <button class="tablinks" onclick="openTab(event, 'Formal')" id="defaultOpen">Formal Suppliers</button>
            <button class="tablinks" onclick="openTab(event, 'Informal')">Informal Artisans</button>
        </div>

        <div id="Formal" class="tabcontent">
            <div class="form-group">
                <label for="formalSupplierName">Supplier Name:</label>
                <input type="text" id="formalSupplierName" placeholder="Enter supplier name">
            </div>
            <div class="form-group">
                <label for="formalSupplierLocation">Supplier Location:</label>
                <input type="text" id="formalSupplierLocation" placeholder="Enter supplier location">
            </div>
            <div class="form-group">
                <label for="formalSupplierType">Supplier Type:</label>
                <select id="formalSupplierType" onchange="toggleFormalSubType()">
                    <option value="">Select Type</option>
                    <option value="fabric">Fabric</option>
                    <option value="trim">Trim</option>
                </select>
            </div>
            <div class="form-group" id="formalSubTypeContainer">
                <label for="formalSubType">Type:</label>
                <select id="formalSubType"></select>
            </div>

            <h3>Quality (C1) <span class="weightage">Weight: 25%</span></h3>
            <div class="form-group">
                <label for="formalDefectRate">Defect Rate (%):</label>
                <input type="number" id="formalDefectRate" min="0" max="100" step="0.1">
            </div>
            <div class="form-group">
                <label for="formalRejectionRate">Rejection Rate (%):</label>
                <input type="number" id="formalRejectionRate" min="0" max="100" step="0.1">
            </div>

            <h3>Cost (C2) <span class="weightage">Weight: 20%</span></h3>
            <div class="form-group">
                <label for="formalProductCost">Product Cost (₹):</label>
                <input type="number" id="formalProductCost" min="0" step="1">
            </div>
            <div class="form-group">
                <label for="formalTransportCost">Transportation Cost (₹):</label>
                <input type="number" id="formalTransportCost" min="0" step="1">
            </div>

            <h3>Delivery (C3) <span class="weightage">Weight: 20%</span></h3>
            <div class="form-group">
                <label for="formalLeadTime">Lead Time (days):</label>
                <input type="number" id="formalLeadTime" min="0" step="1">
            </div>
            <div class="form-group">
                <label for="formalFulfillmentRate">Order Fulfillment Rate (%):</label>
                <input type="number" id="formalFulfillmentRate" min="0" max="100" step="0.1">
            </div>

            <h3>Service (C4) <span class="weightage">Weight: 15%</span></h3>
            <div class="form-group">
                <label for="formalCustomerService">Customer Service Rating (1-10):</label>
                <input type="number" id="formalCustomerService" min="1" max="10" step="1">
            </div>
            <div class="form-group">
                <label for="formalCsr">Social Service (CSR) Contribution (%):</label>
                <input type="number" id="formalCsr" min="0" max="100" step="0.1">
            </div>

            <h3>Environmental Competency (C5) <span class="weightage">Weight: 20%</span></h3>
            <div class="form-group">
                <label for="fabricType">Fabric Type:</label>
                <select id="fabricType">
                    <option value="cotton">Conventional Cotton (~5.9 kg CO₂e/kg)</option>
                    <option value="organic_cotton">Organic Cotton (~3.0 kg CO₂e/kg)</option>
                    <option value="polyester">Polyester (~11.0 kg CO₂e/kg)</option>
                    <option value="silk">Silk (~9.5 kg CO₂e/kg)</option>
                    <option value="wool">Wool (~23.0 kg CO₂e/kg)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="fabricWeight">Fabric Weight (kg):</label>
                <input type="number" id="fabricWeight" min="0" step="0.1">
            </div>
            <div class="form-group">
                <label for="transportMode">Transport Mode:</label>
                <select id="transportMode">
                    <option value="truck">Truck (0.15 kg CO₂e/km/ton)</option>
                    <option value="ship">Ship (0.035 kg CO₂e/km/ton)</option>
                    <option value="air">Air (1.5 kg CO₂e/km/ton)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="distance">Transport Distance (km):</label>
                <input type="number" id="distance" min="0" step="1">
            </div>
            <div class="form-group">
                <label for="electricitySource">Electricity Source:</label>
                <select id="electricitySource">
                    <option value="renewable">Renewable Energy</option>
                    <option value="non-renewable">Non-Renewable Energy</option>
                </select>
            </div>
            <div class="form-group">
                <label>Certifications:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="formalCertifications" value="GOTS"> GOTS (Global Organic Textile Standard) (2.0)</label>
                    <label><input type="checkbox" name="formalCertifications" value="OCS"> OCS (Organic Content Standard) (1.5)</label>
                    <label><input type="checkbox" name="formalCertifications" value="GRS"> GRS (Global Recycled Standard) (1.8)</label>
                    <label><input type="checkbox" name="formalCertifications" value="RCS"> RCS (Recycled Claim Standard) (1.3)</label>
                    <label><input type="checkbox" name="formalCertifications" value="BCI"> Better Cotton Initiative (BCI) (0.8)</label>
                    <label><input type="checkbox" name="formalCertifications" value="bluesign"> bluesign® (1.9)</label>
                    <label><input type="checkbox" name="formalCertifications" value="ZDHC"> ZDHC (Zero Discharge of Hazardous Chemicals) (1.7)</label>
                    <label><input type="checkbox" name="formalCertifications" value="Carbon Trust"> Carbon Trust Certification (1.2)</label>
                    <label><input type="checkbox" name="formalCertifications" value="ISO 14001"> ISO 14001 (1.0)</label>
                    <label><input type="checkbox" name="formalCertifications" value="SA8000"> SA8000 (0.9)</label>
                    <label><input type="checkbox" name="formalCertifications" value="WRAP"> WRAP (0.7)</label>
                    <label><input type="checkbox" name="formalCertifications" value="Fair Trade"> Fair Trade Certified™ (1.4)</label>
                    <label><input type="checkbox" name="formalCertifications" value="Sedex/SMETA"> Sedex/SMETA (1.1)</label>
                    <label><input type="checkbox" name="formalCertifications" value="BSCI"> BSCI (0.6)</label>
                    <label><input type="checkbox" name="formalCertifications" value="ILO Conventions"> ILO Conventions Compliance (0.5)</label>
                    <label><input type="checkbox" name="formalCertifications" value="ISO 9001"> ISO 9001 (0.4)</label>
                    <label><input type="checkbox" name="formalCertifications" value="ISO 20400"> ISO 20400 (0.3)</label>
                    <label><input type="checkbox" name="formalCertifications" value="Higg Index"> Higg Index (1.6)</label>
                    <label><input type="checkbox" name="formalCertifications" value="B Corp"> B Corp Certification (1.5)</label>
                    <label><input type="checkbox" name="formalCertifications" value="OEKO-TEX STeP"> OEKO-TEX® STeP (1.3)</label>
                    <label><input type="checkbox" name="formalCertifications" value="OEKO-TEX Made in Green"> OEKO-TEX® Made in Green (1.7)</label>
                    <label><input type="checkbox" name="formalCertifications" value="FSC"> FSC (Forest Stewardship Council) (1.1)</label>
                    <label><input type="checkbox" name="formalCertifications" value="EcoLabel EU"> EcoLabel (EU) (1.2)</label>
                    <label><input type="checkbox" name="formalCertifications" value="Cradle to Cradle"> Cradle to Cradle Certified® (2.0)</label>
                    <label><input type="checkbox" name="formalCertifications" value="No Certifications"> No Certifications (0.00)</label>
                </div>
            </div>
            <div class="form-group">
                <label>Sustainable Practices:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="formalPractices" value="Certified Sustainable Raw Materials"> Use of Certified Sustainable Raw Materials (2.0)</label>
                    <label><input type="checkbox" name="formalPractices" value="Water and Effluent Management"> Water and Effluent Management (1.8)</label>
                    <label><input type="checkbox" name="formalPractices" value="Energy Efficiency and Renewable Energy Use"> Energy Efficiency and Renewable Energy Use (1.9)</label>
                    <label><input type="checkbox" name="formalPractices" value="Chemical Management Compliance"> Chemical Management Compliance (1.7)</label>
                    <label><input type="checkbox" name="formalPractices" value="Fair Wages and Decent Working Conditions"> Fair Wages and Decent Working Conditions (1.6)</label>
                    <label><input type="checkbox" name="formalPractices" value="No Child or Forced Labor"> No Child or Forced Labor (2.0)</label>
                    <label><input type="checkbox" name="formalPractices" value="Worker Health, Safety & Well-being"> Worker Health, Safety & Well-being (1.5)</label>
                    <label><input type="checkbox" name="formalPractices" value="Carbon Footprint Measurement and Reduction"> Carbon Footprint Measurement and Reduction (1.4)</label>
                    <label><input type="checkbox" name="formalPractices" value="Waste Reduction and Fabric Recycling"> Waste Reduction and Fabric Recycling (1.3)</label>
                    <label><input type="checkbox" name="formalPractices" value="Third-Party Social & Environmental Audits"> Third-Party Social & Environmental Audits (1.1)</label>
                    <label><input type="checkbox" name="formalPractices" value="Gender Inclusivity"> Gender Inclusivity (1.2)</label>
                    <label><input type="checkbox" name="formalPractices" value="None"> None (0.0)</label>
                </div>
            </div>

            <div class="button-group">
                <button onclick="calculateFormalScore()">Calculate Score</button>
                <button onclick="resetFormalForm()">Reset Form</button>
            </div>
            <div id="formalResult"></div>
        </div>

        <div id="Informal" class="tabcontent">
            <div class="form-group">
                <label for="informalSupplierName">Artisan Name:</label>
                <input type="text" id="informalSupplierName" placeholder="Enter artisan name">
            </div>
            <div class="form-group">
                <label for="informalSupplierLocation">Artisan Location:</label>
                <input type="text" id="informalSupplierLocation" placeholder="Enter artisan location">
            </div>
            <div class="form-group">
                <label for="informalSupplierType">Craft Type:</label>
                <select id="informalSupplierType" onchange="toggleInformalSubType()">
                    <option value="">Select Craft</option>
                    <option value="weaving">Weaving</option>
                    <option value="embroidery">Embroidery</option>
                    <option value="knitting">Knitting</option>
                </select>
            </div>
            <div class="form-group" id="informalSubTypeContainer">
                <label for="informalSubType">Specific Craft:</label>
                <select id="informalSubType"></select>
            </div>

            <h3>Craftsmanship Quality (C1) <span class="weightage">Weight: 30%</span></h3>
            <div class="form-group">
                <label for="informalCraftQuality">Craft Quality Rating:</label>
                <select id="informalCraftQuality">
                    <option value="">Select Rating</option>
                    <option value="10">Very High</option>
                    <option value="8">High</option>
                    <option value="6">Medium</option>
                    <option value="4">Low</option>
                    <option value="2">Very Low</option>
                </select>
            </div>
            <div class="form-group">
                <label for="informalConsistency">Consistency Rating:</label>
                <select id="informalConsistency">
                    <option value="">Select Rating</option>
                    <option value="10">Very High</option>
                    <option value="8">High</option>
                    <option value="6">Medium</option>
                    <option value="4">Low</option>
                    <option value="2">Very Low</option>
                </select>
            </div>

            <h3>Cost (C2) <span class="weightage">Weight: 20%</span></h3>
            <div class="form-group">
                <label for="informalProductCost">Product Cost (₹):</label>
                <input type="number" id="informalProductCost" min="0" step="1">
            </div>

            <h3>Delivery (C3) <span class="weightage">Weight: 20%</span></h3>
            <div class="form-group">
                <label for="informalLeadTime">Lead Time (days):</label>
                <input type="number" id="informalLeadTime" min="0" step="1">
            </div>
            <div class="form-group">
                <label for="informalReliability">Delivery Reliability Rating:</label>
                 <select id="informalReliability">
                    <option value="">Select Rating</option>
                    <option value="10">Very High</option>
                    <option value="8">High</option>
                    <option value="6">Medium</option>
                    <option value="4">Low</option>
                    <option value="2">Very Low</option>
                </select>
            </div>

            <h3>Community Impact (C4) <span class="weightage">Weight: 15%</span></h3>
            <div class="form-group">
                <label for="informalCommunitySupport">Community Support Rating:</label>
                <select id="informalCommunitySupport">
                    <option value="">Select Rating</option>
                    <option value="10">Very High</option>
                    <option value="8">High</option>
                    <option value="6">Medium</option>
                    <option value="4">Low</option>
                    <option value="2">Very Low</option>
                </select>
            </div>
            <div class="form-group">
                <label for="informalEmployment">Local Employment Impact (1-10):</label>
                <input type="number" id="informalEmployment" min="1" max="10" step="1">
            </div>

            <h3>Environmental Sustainability (C5) <span class="weightage">Weight: 15%</span></h3>
            <div class="form-group">
                <label for="informalFabricType">Material Type:</label>
                <select id="informalFabricType">
                    <option value="cotton">Conventional Cotton (~5.9 kg CO₂e/kg)</option>
                    <option value="organic_cotton">Organic Cotton (~3.0 kg CO₂e/kg)</option>
                    <option value="polyester">Polyester (~11.0 kg CO₂e/kg)</option>
                    <option value="silk">Silk (~9.5 kg CO₂e/kg)</option>
                    <option value="wool">Wool (~23.0 kg CO₂e/kg)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="informalFabricWeight">Material Weight (kg):</label>
                <input type="number" id="informalFabricWeight" min="0" step="0.1">
            </div>
            <div class="form-group">
                <label for="informalTransportMode">Transport Mode:</label>
                <select id="informalTransportMode">
                    <option value="truck">Truck (0.15 kg CO₂e/km/ton)</option>
                    <option value="ship">Ship (0.035 kg CO₂e/km/ton)</option>
                    <option value="air">Air (1.5 kg CO₂e/km/ton)</option>
                </select>
            </div>
             <div class="form-group">
                <label for="informalDistance">Transport Distance (km):</label>
                <input type="number" id="informalDistance" min="0" step="1">
            </div>
            <div class="form-group">
                <label for="informalElectricitySource">Electricity Source:</label>
                <select id="informalElectricitySource">
                    <option value="renewable">Renewable Energy</option>
                    <option value="non-renewable">Non-Renewable Energy</option>
                </select>
            </div>
            <div class="form-group">
                <label>Sustainable Practices:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="informalPractices" value="Handmade"> Handmade (1.0)</label>
                    <label><input type="checkbox" name="informalPractices" value="Natural Dyes Used"> Natural Dyes Used (0.8)</label>
                    <label><input type="checkbox" name="informalPractices" value="Local Materials Sourced"> Local Materials Sourced (0.6)</label>
                    <label><input type="checkbox" name="informalPractices" value="Low Waste Generation"> Low Waste Generation (0.4)</label>
                    <label><input type="checkbox" name="informalPractices" value="Fair Wages Paid"> Fair Wages Paid (1.0)</label>
                    <label><input type="checkbox" name="informalPractices" value="Safe & Hygienic Working Conditions"> Safe & Hygienic Working Conditions (0.8)</label>
                    <label><input type="checkbox" name="informalPractices" value="No Child Labor"> No Child Labor (1.0)</label>
                     <label><input type="checkbox" name="informalPractices" value="Community Employment or Training"> Community Employment or Training (0.6)</label>
                    <label><input type="checkbox" name="informalPractices" value="Gender Inclusivity"> Gender Inclusivity (1.2)</label>
                    <label><input type="checkbox" name="informalPractices" value="None"> None (0.0)</label>
                </div>
            </div>

            <div class="button-group">
                <button onclick="calculateInformalScore()">Calculate Score</button>
                <button onclick="resetInformalForm()">Reset Form</button>
            </div>
            <div id="informalResult"></div>
        </div>
    </div>

    <script>
        // Formal Types
        const fabricTypes = ['Cotton', 'Polyester', 'Silk', 'Wool', 'Linen', 'Denim', 'Rayon', 'Velvet'];
        const trimTypes = ['Buttons', 'Zippers', 'Threads', 'Labels', 'Elastic', 'Beads', 'Lace', 'Ribbons'];

        // Informal Types
        const weavingTypes = ['Handloom', 'Powerloom', 'Knitting', 'Crochet'];
        const embroideryTypes = ['Hand Embroidery', 'Machine Embroidery', 'Appliqué', 'Cross-Stitch'];
        const potteryTypes = ['Earthenware', 'Stoneware', 'Porcelain'];

        // Weightage for Electricity Sources (Example - to be updated with actual research data)
        const electricityWeightage = {
            renewable: 0.2,
            'non-renewable': 0.5
        };

        // Formal Weightages
        const formalCertificationWeights = {
            'GOTS': 2.0, 'OCS': 1.5, 'GRS': 1.8, 'RCS': 1.3, 'BCI': 0.8, 'bluesign': 1.9, 'ZDHC': 1.7,
            'Carbon Trust': 1.2, 'ISO 14001': 1.0, 'SA8000': 0.9, 'WRAP': 0.7, 'Fair Trade': 1.4,
            'Sedex/SMETA': 1.1, 'BSCI': 0.6, 'ILO Conventions': 0.5, 'ISO 9001': 0.4, 'ISO 20400': 0.3,
            'Higg Index': 1.6, 'B Corp': 1.5, 'OEKO-TEX STeP': 1.3, 'OEKO-TEX Made in Green': 1.7,
            'FSC': 1.1, 'EcoLabel EU': 1.2, 'Cradle to Cradle': 2.0, 'No Certifications': 0.00
        };
        const formalPracticeWeights = {
            'Certified Sustainable Raw Materials': 2.0, 'Water and Effluent Management': 1.8,
            'Energy Efficiency and Renewable Energy Use': 1.9, 'Chemical Management Compliance': 1.7,
            'Fair Wages and Decent Working Conditions': 1.6, 'No Child or Forced Labor': 2.0,
            'Worker Health, Safety & Well-being': 1.5, 'Carbon Footprint Measurement and Reduction': 1.4,
            'Waste Reduction and Fabric Recycling': 1.3, 'Third-Party Social & Environmental Audits': 1.1, 'Gender Inclusivity': 1.2, 'None': 0.0
        };
        const formalCriteriaWeights = {
            c1: 0.25, // Quality
            c2: 0.20, // Cost
            c3: 0.20, // Delivery
            c4: 0.15, // Service
            c5: 0.20  // Environmental Competency
        };

        // Informal Weightages
        const informalPracticeWeights = {
            'Handmade': 1.0,
            'Natural Dyes Used': 0.8,
            'Local Materials Sourced': 0.6,
            'Low Waste Generation': 0.4,
            'Fair Wages Paid': 1.0,
            'Safe & Hygienic Working Conditions': 0.8,
            'No Child Labor': 1.0,
            'Community Employment or Training': 0.6,
            'Gender Inclusivity': 1.2,
            'None': 0.0
        };
        const informalCriteriaWeights = {
            c1: 0.30, // Craftsmanship Quality
            c2: 0.20, // Cost
            c3: 0.20, // Delivery
            c4: 0.15, // Community Impact
            c5: 0.15  // Environmental Sustainability
        };

        // Carbon Footprint Factors
        const fabricFactors = {
            cotton: 5.9,
            organic_cotton: 3.0,
            polyester: 11.0,
            silk: 9.5,
            wool: 23.0
        };
        const transportFactors = {
            truck: 0.15,
            ship: 0.035,
            air: 1.5
        };

        // Tab Functionality
        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tabcontent");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            const tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
        // Ensure defaultOpen element exists before clicking
        if (document.getElementById("defaultOpen")) {
            document.getElementById("defaultOpen").click();
        }


        // Toggle Sub-Types
        function toggleFormalSubType() {
            const supplierType = document.getElementById('formalSupplierType').value;
            const subTypeContainer = document.getElementById('formalSubTypeContainer');
            const subTypeSelect = document.getElementById('formalSubType');

            subTypeSelect.innerHTML = '<option value="">Select Sub-Type</option>'; // Clear previous options
            if (supplierType === 'fabric') {
                fabricTypes.forEach(type => subTypeSelect.innerHTML += `<option value="${type}">${type}</option>`);
                subTypeContainer.style.display = 'block';
            } else if (supplierType === 'trim') {
                trimTypes.forEach(type => subTypeSelect.innerHTML += `<option value="${type}">${type}</option>`);
                subTypeContainer.style.display = 'block';
            } else {
                subTypeContainer.style.display = 'none';
            }
        }

        function toggleInformalSubType() {
            const supplierType = document.getElementById('informalSupplierType').value;
            const subTypeContainer = document.getElementById('informalSubTypeContainer');
            const subTypeSelect = document.getElementById('informalSubType');

            subTypeSelect.innerHTML = '<option value="">Select Specific Craft</option>'; // Clear previous options
            if (supplierType === 'weaving') {
                weavingTypes.forEach(type => subTypeSelect.innerHTML += `<option value="${type}">${type}</option>`);
                subTypeContainer.style.display = 'block';
            } else if (supplierType === 'embroidery') {
                embroideryTypes.forEach(type => subTypeSelect.innerHTML += `<option value="${type}">${type}</option>`);
                subTypeContainer.style.display = 'block';
            } else if (supplierType === 'pottery') { // Added pottery as per your arrays
                potteryTypes.forEach(type => subTypeSelect.innerHTML += `<option value="${type}">${type}</option>`);
                subTypeContainer.style.display = 'block';
            } else {
                subTypeContainer.style.display = 'none';
            }
        }

        // Send Data to Google Sheets
        async function sendDataToServer(data) {
            console.log('Sending data to Google Sheets:', data);
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbzMslW1WPd_PY8N8hqqCb8-40XLa2VveSP0KU4YpM9K0Mz1ToZhLPRfH1kXNGILUKBWNA/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data),
                    mode: 'no-cors' // Important for sending to Google Apps Script from client-side if not handling CORS on script side
                });
                console.log('Data sent successfully to Google Sheets (response not directly readable due to no-cors)');
            } catch (error) {
                console.error('Error sending data:', error);
                // It's better to inform the user through the UI rather than alert
                // For example, update a status message on the page.
                // alert('Failed to save data to Google Sheets: ' + error.message);
                const resultDiv = data.supplierType === 'fabric' || data.supplierType === 'trim' ? document.getElementById('formalResult') : document.getElementById('informalResult');
                if(resultDiv) {
                    resultDiv.innerHTML += '<br><span style="color: red;">Failed to save data to Google Sheets.</span>';
                }
            }
        }

        // Formal Score Calculation
        function calculateFormalScore() {
            console.log('calculateFormalScore triggered');
            // Retrieve data from form fields
            const data = {
                supplierName: document.getElementById('formalSupplierName').value || '',
                supplierLocation: document.getElementById('formalSupplierLocation').value || '',
                supplierType: document.getElementById('formalSupplierType').value || '',
                subType: document.getElementById('formalSubType').value || '',
                defectRate: parseFloat(document.getElementById('formalDefectRate').value) || 0,
                rejectionRate: parseFloat(document.getElementById('formalRejectionRate').value) || 0,
                productCost: parseFloat(document.getElementById('formalProductCost').value) || 0,
                transportCost: parseFloat(document.getElementById('formalTransportCost').value) || 0,
                leadTime: parseFloat(document.getElementById('formalLeadTime').value) || 0,
                fulfillmentRate: parseFloat(document.getElementById('formalFulfillmentRate').value) || 0,
                customerService: parseFloat(document.getElementById('formalCustomerService').value) || 0,
                csr: parseFloat(document.getElementById('formalCsr').value) || 0,
                fabricType: document.getElementById('fabricType').value || 'cotton', // Default if not selected
                fabricWeight: parseFloat(document.getElementById('fabricWeight').value) || 0,
                transportMode: document.getElementById('transportMode').value || 'truck', // Default if not selected
                distance: parseFloat(document.getElementById('distance').value) || 0,
                electricitySource: document.getElementById('electricitySource').value || 'non-renewable', // Default
                certifications: Array.from(document.querySelectorAll('input[name="formalCertifications"]:checked')).map(input => input.value),
                practices: Array.from(document.querySelectorAll('input[name="formalPractices"]:checked')).map(input => input.value),
                timestamp: new Date().toISOString(),
                formType: 'Formal' // Added to help server distinguish
            };

            // Min-Max values for normalization (example values, adjust as needed)
            const minMax = {
                productCost: { min: 1000, max: 50000 },
                transportCost: { min: 500, max: 20000 },
                leadTime: { min: 5, max: 60 }
            };

            // Calculate scores for each criterion (C1-C5)
            // C1: Quality (Defect Rate, Rejection Rate) - Lower is better
            const c1_defect_score = Math.max(1, 10 - (data.defectRate / 10)); // Assuming 100% defect rate = score 0, 0% = score 10
            const c1_rejection_score = Math.max(1, 10 - (data.rejectionRate / 10));
            const c1Raw = (c1_defect_score + c1_rejection_score) / 2;

            // C2: Cost (Product Cost, Transport Cost) - Lower is better, normalized
            const c2_product_score = 10 - 9 * Math.max(0, Math.min(1, (data.productCost - minMax.productCost.min) / (minMax.productCost.max - minMax.productCost.min)));
            const c2_transport_score = 10 - 9 * Math.max(0, Math.min(1, (data.transportCost - minMax.transportCost.min) / (minMax.transportCost.max - minMax.transportCost.min)));
            const c2Raw = (c2_product_score + c2_transport_score) / 2;

            // C3: Delivery (Lead Time, Fulfillment Rate)
            const c3_leadtime_score = 10 - 9 * Math.max(0, Math.min(1, (data.leadTime - minMax.leadTime.min) / (minMax.leadTime.max - minMax.leadTime.min))); // Lower lead time is better
            const c3_fulfillment_score = data.fulfillmentRate / 10; // Higher fulfillment is better (0-100% maps to 0-10)
            const c3Raw = (c3_leadtime_score + c3_fulfillment_score) / 2;

            // C4: Service (Customer Service, CSR) - Higher is better
            const c4_service_score = data.customerService; // Already 1-10
            const c4_csr_score = data.csr / 10; // CSR % to 0-10 scale
            const c4Raw = (c4_service_score + c4_csr_score) / 2;

            // C5: Environmental Competency
            const fabricEmissions = (data.fabricWeight * (fabricFactors[data.fabricType] || 0));
            const transportEmissions = (data.fabricWeight / 1000) * data.distance * (transportFactors[data.transportMode] || 0);
            const electricityEmissionsScore = data.electricitySource === 'renewable' ? 10 : 2; // Higher score for renewable
            
            const totalActualEmissions = fabricEmissions + transportEmissions; // This is actual kg CO2e
            // Normalize emissions: lower is better. Assume a benchmark, e.g., 500kg CO2e is very bad (score 1), 0kg is best (score 10)
            const c5_emissions_score = Math.max(1, 10 - 9 * (totalActualEmissions / 500));


            const c5_cert_score = data.certifications.length > 0 && !data.certifications.includes('No Certifications') ?
                                 data.certifications.reduce((sum, cert) => sum + (formalCertificationWeights[cert] || 0), 0) : 0;
            // Normalize cert score if it can exceed 10
            const normalized_c5_cert_score = Math.min(10, c5_cert_score);


            const c5_practice_score = data.practices.length > 0 && !data.practices.includes('None') ?
                                   data.practices.reduce((sum, practice) => sum + (formalPracticeWeights[practice] || 0), 0) : 0;
            // Normalize practice score if it can exceed 10
            const normalized_c5_practice_score = Math.min(10, c5_practice_score);

            const c5Raw = (c5_emissions_score + normalized_c5_cert_score + normalized_c5_practice_score + electricityEmissionsScore) / 4;


            // Calculate total weighted score
            const totalScoreRaw = (c1Raw * formalCriteriaWeights.c1) +
                                  (c2Raw * formalCriteriaWeights.c2) +
                                  (c3Raw * formalCriteriaWeights.c3) +
                                  (c4Raw * formalCriteriaWeights.c4) +
                                  (c5Raw * formalCriteriaWeights.c5);
            const totalScore = Math.max(1, Math.min(10, totalScoreRaw)); // Ensure score is between 1 and 10

            // Display result
            const resultDiv = document.getElementById('formalResult');
            let colorClass = '', assessment = '';
            if (totalScore >= 7.5) { // Adjusted thresholds
                colorClass = 'green';
                assessment = 'Good Supplier - Recommended';
            } else if (totalScore >= 4) {
                colorClass = 'yellow';
                assessment = 'Average Supplier - Consider with Caution';
            } else {
                colorClass = 'red';
                assessment = 'Poor Supplier - Not Recommended';
            }

            resultDiv.innerHTML = `<strong>Total Score: ${totalScore.toFixed(2)} / 10</strong><br>${assessment}<br>Estimated CO₂ Emissions: ${totalActualEmissions.toFixed(2)} kg`;
            resultDiv.className = 'result ' + colorClass; // Keep 'result' class for base styling
            resultDiv.style.display = 'block';

            // Prepare data for sending to server
            data.totalScore = totalScore.toFixed(2);
            data.assessment = assessment;
            data.totalEmissions = totalActualEmissions.toFixed(2); // Send actual emissions
            sendDataToServer(data);
        }


        // Informal Score Calculation
        function calculateInformalScore() {
            console.log('calculateInformalScore triggered');
            // Retrieve data from form fields
            const data = {
                supplierName: document.getElementById('informalSupplierName').value || '',
                supplierLocation: document.getElementById('informalSupplierLocation').value || '',
                supplierType: document.getElementById('informalSupplierType').value || '',
                subType: document.getElementById('informalSubType').value || '',
                craftQuality: parseFloat(document.getElementById('informalCraftQuality').value) || 0, // Now a select
                consistency: parseFloat(document.getElementById('informalConsistency').value) || 0,   // Now a select
                productCost: parseFloat(document.getElementById('informalProductCost').value) || 0,
                leadTime: parseFloat(document.getElementById('informalLeadTime').value) || 0,
                reliability: parseFloat(document.getElementById('informalReliability').value) || 0, // Now a select
                communitySupport: parseFloat(document.getElementById('informalCommunitySupport').value) || 0, // Now a select
                employment: parseFloat(document.getElementById('informalEmployment').value) || 0,
                fabricType: document.getElementById('informalFabricType').value || 'cotton',
                fabricWeight: parseFloat(document.getElementById('informalFabricWeight').value) || 0,
                transportMode: document.getElementById('informalTransportMode').value || 'truck',
                distance: parseFloat(document.getElementById('informalDistance').value) || 0,
                informalElectricitySource: document.getElementById('informalElectricitySource').value || 'non-renewable',
                practices: Array.from(document.querySelectorAll('input[name="informalPractices"]:checked')).map(input => input.value),
                timestamp: new Date().toISOString(),
                formType: 'Informal' // Added to help server distinguish
            };

            // Min-Max values for normalization
            const minMax = {
                productCost: { min: 100, max: 5000 },
                leadTime: { min: 1, max: 30 }
            };

            // C1: Craftsmanship Quality (Quality, Consistency) - Higher is better (already 0-10 from select)
            const c1Raw = (data.craftQuality + data.consistency) / 2;

            // C2: Cost (Product Cost) - Lower is better, normalized
            const c2Raw = 10 - 9 * Math.max(0, Math.min(1, (data.productCost - minMax.productCost.min) / (minMax.productCost.max - minMax.productCost.min)));

            // C3: Delivery (Lead Time, Reliability)
            const c3_leadtime_score = 10 - 9 * Math.max(0, Math.min(1, (data.leadTime - minMax.leadTime.min) / (minMax.leadTime.max - minMax.leadTime.min)));
            const c3_reliability_score = data.reliability; // Already 0-10 from select
            const c3Raw = (c3_leadtime_score + c3_reliability_score) / 2;

            // C4: Community Impact (Support, Employment) - Higher is better
            const c4_support_score = data.communitySupport; // Already 0-10 from select
            const c4_employment_score = data.employment; // Already 1-10
            const c4Raw = (c4_support_score + c4_employment_score) / 2;

            // C5: Environmental Sustainability
            const fabricEmissions = (data.fabricWeight * (fabricFactors[data.fabricType] || 0));
            const transportEmissions = (data.fabricWeight / 1000) * data.distance * (transportFactors[data.transportMode] || 0);
            // POTENTIAL ISSUE: data.informalElectricity is not defined or collected from any form field if you intended a quantity.
            // The line below uses your last provided logic.
            // If you meant to use a fixed score based on source type (like in formal), it should be:
            // const electricityEmissionsScore = data.informalElectricitySource === 'renewable' ? 10 : 2;
            // If you intended to use a quantity, an input for `data.informalElectricity` (e.g., kWh) is needed.
            // As it stands, `data.informalElectricity` will be undefined, leading to NaN if not handled.
            // For now, let's assume you wanted a score similar to formal, or a direct weightage.
            // Reverting to a simpler score for electricity source for now to avoid NaN:
            const electricityEmissionsScore = data.informalElectricitySource === 'renewable' ? 10 : 2; // Higher score for renewable

            const totalActualEmissions = fabricEmissions + transportEmissions; // Actual kg CO2e

            // Normalize emissions: lower is better. Assume a benchmark, e.g., 100kg CO2e is very bad (score 1), 0kg is best (score 10)
            const c5_emissions_score = Math.max(1, 10 - 9 * (totalActualEmissions / 100));

            const c5_practice_score = data.practices.length > 0 && !data.practices.includes('None') ?
                                   data.practices.reduce((sum, practice) => sum + (informalPracticeWeights[practice] || 0), 0) : 0;
            const normalized_c5_practice_score = Math.min(10, c5_practice_score); // Normalize

            const c5Raw = (c5_emissions_score + normalized_c5_practice_score + electricityEmissionsScore) / 3;


            // Calculate total weighted score
            const totalScoreRaw = (c1Raw * informalCriteriaWeights.c1) +
                                  (c2Raw * informalCriteriaWeights.c2) +
                                  (c3Raw * informalCriteriaWeights.c3) +
                                  (c4Raw * informalCriteriaWeights.c4) +
                                  (c5Raw * informalCriteriaWeights.c5);
            const totalScore = Math.max(1, Math.min(10, totalScoreRaw));

            // Display result
            const resultDiv = document.getElementById('informalResult');
            let colorClass = '', assessment = '';
             if (totalScore >= 7.5) { // Adjusted thresholds
                colorClass = 'green';
                assessment = 'Good Artisan - Recommended';
            } else if (totalScore >= 4) {
                colorClass = 'yellow';
                assessment = 'Average Artisan - Consider with Caution';
            } else {
                colorClass = 'red';
                assessment = 'Poor Artisan - Not Recommended';
            }

            resultDiv.innerHTML = `<strong>Total Score: ${totalScore.toFixed(2)} / 10</strong><br>${assessment}<br>Estimated CO₂ Emissions: ${totalActualEmissions.toFixed(2)} kg`;
            resultDiv.className = 'result ' + colorClass;
            resultDiv.style.display = 'block';

            // Prepare data for sending to server
            data.totalScore = totalScore.toFixed(2);
            data.assessment = assessment;
            data.totalEmissions = totalActualEmissions.toFixed(2);
            sendDataToServer(data);
        }


        // Reset Functions
        function resetFormalForm() {
            document.getElementById('Formal').querySelectorAll('input, select').forEach(input => {
                if (input.type === 'checkbox') {
                    input.checked = false;
                } else {
                    input.value = '';
                }
            });
            document.getElementById('formalSubTypeContainer').style.display = 'none';
            const resultDiv = document.getElementById('formalResult');
            if (resultDiv) {
                resultDiv.innerHTML = '';
                resultDiv.className = 'result'; // Reset class
                resultDiv.style.display = 'none'; // Hide it
            }
        }

        function resetInformalForm() {
            document.getElementById('Informal').querySelectorAll('input, select').forEach(input => {
                 if (input.type === 'checkbox') {
                    input.checked = false;
                } else {
                    input.value = '';
                }
            });
            document.getElementById('informalSubTypeContainer').style.display = 'none';
            const resultDiv = document.getElementById('informalResult');
            if (resultDiv) {
                resultDiv.innerHTML = '';
                resultDiv.className = 'result'; // Reset class
                resultDiv.style.display = 'none'; // Hide it
            }
        }
    </script>
</body>

</html>
